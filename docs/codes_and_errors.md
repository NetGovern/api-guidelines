# HTTP Status Codes and Errors

## General

You MUST define all success responses in API specification.

You MUST define all error repospense in API specification if they convey application-specific funcational sematics or are used in non-standard way. Otherwise, combine them using the following pattern (OpenAPI 3):

```yaml
responses:
    ...
    default:
        description: Error occurred. See status code and problem object for more information.
        content:
            "application/problem+json":
                schema:
                    $ref: <ref to common Probem schema >
```


## Allowed status codes

- APIs MUST NOT return a status code that is not defined in this table.
- APIs MAY return only some of status codes defined in this table.

### Success codes

| Code | Description | Methods |
| ---- | ----------- | ------- |
| 200 OK | The standard success response. | \<all\> |
| 201 Created | Returned on successful entity creation. | POST |
| 202 Accepted | The request was successful and will be processed asynchronously. | POST, PUT, PATCH, DELETE |
| 204 No Content | There is no response body. | HEAD, DELETE |
| 207 Multi-Status | The response body contains multiple status informations for different parts of a [bulk request](patterns.md#Bulk-operations). | POST |


### Client side error codes

| Code | Description | Methods |
| ---- | ----------- | ------- |
| 400 Bad Request | Generic error. Should also be used in case of failing business logic validation. | \<all\> |
| 401 Unauthorized | Request failed because client is not authenticated. | \<all\> |
| 403 Forbidden | Request failed because client does not have authorization to access a specific resource. | \<all\> |
| 404 Not Found | The server has not found anything matching the request URI. This either means that the URI is incorrect or the resource is not available. | \<all\> |
| 405 Method Not Allowed | The server has not implemented the requested HTTP method. This is typically default behavior for API frameworks. | \<all\> |
| 406 Not Acceptable | The server MUST return this status code when it cannot return the payload of the response using the media type requested by the client. For example, if the client sends an `Accept: application/xml` header, and the API can only generate `application/json`. | \<all\> |
| 415 Unsupported Media Type | The server MUST return this status code when the media type of the request's payload cannot be processed or client sends request without content type. For example, if the client sends a `Content-Type: application/xml` header, but the API can only accept `application/json`. | POST, PUT, PATCH, DELETE |
| 429 Too Many Requests | The server must return this status code if the rate limit for the client has exceeded a predefined value. | \<all\> |


### Server side error codes

| Code | Description | Methods |
| ---- | ----------- | ------- |
| 500 Internal Server Error | A generic error indicating an unexpected server execution problem. Client retry may be sensible. | \<all\> |
| 503 Service Unavailable | The server is temporarily unable to handle the request for a service. | \<all\> |


## Errors

The [`application/problem+json`](https://tools.ietf.org/html/rfc7807) MUST be used to communicate details about an error.

Problem Detail is intended for use with the HTTP status codes 4xx and 5xx.

The RFC encourages problem types to be URI references pointing to the human-readable documentation, but we decided to follow [Zalando approach](https://opensource.zalando.com/restful-api-guidelines/#176). Thus, our problem types are not meant to be resolved and a valid format is: `/problems/unknown-location`.

Example schema:

```yaml
Problem:
  title: Problem
  type: object
  properties:
    type:
      type: string
      description: Problem identifier defined as relative URI reference.
    title:
      type: string
      description: 'A short, summary of the problem type. Written in english and readable for engineers (usually not suited for non technical stakeholders and not localized)'
    detail:
      type: string
      description: A human readable explanation specific to this occurrence of the problem.
    status:
      type: integer
      description: The HTTP status code generated by the origin server for this occurrence of the problem.
      format: int32
      example: 503
      minimum: 100
      maximum: 600
      exclusiveMaximum: true
    instance:
      type: string
      description: An absolute URI that identifies the specific occurrence of the problem.
      format: uri
  required:
    - title
    - detail
    - status
    - type
```

Bulk error handling [is discussed here](patterns.md#Bulk-operations).
